<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø³ÙˆÙ‚ ÙˆÙŠØ§Ùƒ | Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Tajawal for modern Arabic look -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js for Admin Dashboard (Optional viz) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f8fafc;
            scroll-behavior: smooth;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #10b981; /* Emerald 500 */
            border-radius: 4px;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #10b981;
            width: 24px;
            height: 24px;
            -webkit-animation: spin 1s linear infinite; /* Safari */
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .chat-slide-in {
            animation: slideIn 0.3s ease-out forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- Firebase Config & Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, orderBy, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = __app_id;

        let currentUser = null;
        let isAdmin = false;
        let currentChatId = null; // For User
        let adminActiveChatId = null; // For Admin

        // --- Auth ---
        signInAnonymously(auth).catch((error) => {
            console.error("Auth Error", error);
            showToast("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±", "error");
        });

        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                loadListings();
                setupUserChatListener(); 
            }
        });

        // --- Global State ---
        window.appState = {
            listings: [],
            isAdmin: false
        };

        // --- DOM Elements ---
        const listingsContainer = document.getElementById('listings-grid');
        const featuredContainer = document.getElementById('featured-grid');
        const chatWindow = document.getElementById('chat-window');
        const chatMessages = document.getElementById('chat-messages');
        const adminPanel = document.getElementById('admin-panel'); // Dashboard
        
        // --- Logic: Listings ---

        // Compress Image to Base64
        window.handleImageUpload = (input) => {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (event) => {
                const img = new Image();
                img.src = event.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Resize logic (Max width 800px)
                    const MAX_WIDTH = 800;
                    const scaleSize = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scaleSize;

                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    // Compress to JPEG 0.6 quality
                    const dataUrl = canvas.toDataURL('image/jpeg', 0.6); 
                    document.getElementById('preview-image').src = dataUrl;
                    document.getElementById('preview-image').classList.remove('hidden');
                    window.uploadedBase64 = dataUrl;
                }
            }
        };

        window.submitListing = async () => {
            const title = document.getElementById('prop-title').value;
            const price = document.getElementById('prop-price').value;
            const type = document.getElementById('prop-type').value;
            const location = document.getElementById('prop-location').value;
            const desc = document.getElementById('prop-desc').value;
            const phone = document.getElementById('prop-phone').value; // Seller phone
            
            if(!title || !price || !window.uploadedBase64) {
                showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ±ÙØ¹ ØµÙˆØ±Ø©', 'error');
                return;
            }

            document.getElementById('submit-btn-text').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...';
            
            try {
                await addDoc(collection(db, `artifacts/${appId}/public/data/listings`), {
                    title, price: Number(price), type, location, desc, phone,
                    image: window.uploadedBase64,
                    isPinned: false,
                    createdAt: serverTimestamp(),
                    authorId: currentUser.uid
                });
                showToast('ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                document.getElementById('add-listing-modal').classList.add('hidden');
                // Reset form
                document.getElementById('listing-form').reset();
                document.getElementById('preview-image').classList.add('hidden');
                window.uploadedBase64 = null;
            } catch (e) {
                console.error(e);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ø´Ø±', 'error');
            } finally {
                document.getElementById('submit-btn-text').textContent = 'Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†';
            }
        };

        function loadListings() {
            const q = query(collection(db, `artifacts/${appId}/public/data/listings`)); // Ordering handled in JS to avoid index issues
            
            onSnapshot(q, (snapshot) => {
                const listings = [];
                snapshot.forEach(doc => listings.push({id: doc.id, ...doc.data()}));
                
                // Sort locally by date (newest first)
                listings.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                
                window.appState.listings = listings;
                renderListings(listings);
            });
        }

        function renderListings(listings) {
            listingsContainer.innerHTML = '';
            featuredContainer.innerHTML = '';
            let hasFeatured = false;

            listings.forEach(item => {
                const card = createCardHTML(item);
                
                if(item.isPinned) {
                    hasFeatured = true;
                    featuredContainer.innerHTML += card;
                }
                listingsContainer.innerHTML += card;
            });

            // Toggle Featured Section visibility
            const featuredSection = document.getElementById('featured-section');
            if(hasFeatured) {
                featuredSection.classList.remove('hidden');
            } else {
                featuredSection.classList.add('hidden');
            }
            
            lucide.createIcons();
        }

        function createCardHTML(item) {
            const deleteBtn = window.appState.isAdmin ? 
                `<button onclick="deleteListing('${item.id}')" class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full shadow hover:bg-red-600 z-10"><i data-lucide="trash-2" class="w-4 h-4"></i></button>` : '';
            
            const pinBtn = window.appState.isAdmin ? 
                `<button onclick="togglePin('${item.id}', ${item.isPinned})" class="absolute top-2 left-2 ${item.isPinned ? 'bg-yellow-400 text-white' : 'bg-gray-200 text-gray-600'} p-2 rounded-full shadow hover:bg-yellow-500 z-10"><i data-lucide="star" class="w-4 h-4"></i></button>` : '';

            return `
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover relative group">
                    ${deleteBtn}
                    ${pinBtn}
                    <div class="h-48 bg-gray-200 relative overflow-hidden">
                        <img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                        <div class="absolute bottom-0 right-0 bg-emerald-600 text-white px-3 py-1 rounded-tl-lg text-sm font-bold">
                            ${item.type === 'rent' ? 'Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±' : 'Ù„Ù„Ø¨ÙŠØ¹'}
                        </div>
                    </div>
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-lg font-bold text-slate-800 truncate">${item.title}</h3>
                            <span class="text-emerald-600 font-bold text-lg">${item.price.toLocaleString()} Ø¬.Ù…</span>
                        </div>
                        <div class="flex items-center text-slate-500 text-sm mb-3">
                            <i data-lucide="map-pin" class="w-4 h-4 ml-1"></i>
                            ${item.location}
                        </div>
                        <p class="text-slate-600 text-sm mb-4 line-clamp-2 h-10">${item.desc}</p>
                        
                        <div class="border-t pt-4 flex gap-2">
                            <a href="https://wa.me/20${item.phone}?text=Ø£Ù†Ø§ Ù…Ù‡ØªÙ… Ø¨Ø¥Ø¹Ù„Ø§Ù†Ùƒ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ ÙˆÙŠØ§Ùƒ: ${item.title}" target="_blank" class="flex-1 bg-emerald-500 hover:bg-emerald-600 text-white py-2 rounded-lg flex items-center justify-center gap-2 transition">
                                <i data-lucide="message-circle" class="w-4 h-4"></i>
                                ÙˆØ§ØªØ³Ø§Ø¨
                            </a>
                            <a href="tel:${item.phone}" class="bg-slate-100 hover:bg-slate-200 text-slate-700 p-2 rounded-lg transition">
                                <i data-lucide="phone" class="w-5 h-5"></i>
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- Admin Actions ---
        window.togglePin = async (id, currentStatus) => {
            try {
                await updateDoc(doc(db, `artifacts/${appId}/public/data/listings`, id), {
                    isPinned: !currentStatus
                });
                showToast(currentStatus ? 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª' : 'ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©', 'success');
            } catch(e) { console.error(e); }
        };

        window.deleteListing = async (id) => {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.')) { // Using confirm for critical action is okay, but better custom modal. Using browser default for speed in admin.
                try {
                    await deleteDoc(doc(db, `artifacts/${appId}/public/data/listings`, id));
                    showToast('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'success');
                } catch(e) { console.error(e); }
            }
        };

        // --- Admin Login (The "Cheat Code") ---
        window.adminLoginTrigger = () => {
            const logo = document.getElementById('site-logo');
            logo.addEventListener('click', () => {
                const code = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:");
                if(code === '1532') {
                    window.appState.isAdmin = true;
                    isAdmin = true;
                    showToast("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù…Ø¯ÙŠØ± - ÙˆØ¶Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ù…ÙØ¹Ù„", 'success');
                    document.body.classList.add('admin-mode'); // CSS hook
                    renderListings(window.appState.listings); // Re-render to show buttons
                    
                    // Switch floating button to Admin Dashboard
                    document.getElementById('fab-icon-user').classList.add('hidden');
                    document.getElementById('fab-icon-admin').classList.remove('hidden');
                }
            });
        }
        window.adminLoginTrigger();

        // --- Support Chat System ---

        // 1. User Side
        window.toggleChat = () => {
            if(isAdmin) {
                toggleAdminPanel();
                return;
            }
            const cw = document.getElementById('chat-window');
            cw.classList.toggle('hidden');
            if(!cw.classList.contains('hidden') && !currentChatId) {
                // Start bot flow
                appendMessage('bot', 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ ÙˆÙŠØ§Ùƒ! Ø£Ù†Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ. Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ');
            }
        };

        // 2. Admin Dashboard
        window.toggleAdminPanel = () => {
            const panel = document.getElementById('admin-panel');
            panel.classList.toggle('hidden');
            if(!panel.classList.contains('hidden')) {
                loadActiveChats();
            }
        }

        window.sendMessage = async () => {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if(!text) return;
            
            input.value = '';
            
            // If chat doesn't exist yet (Bot Flow)
            if(!currentChatId) {
                handleBotFlow(text);
                return;
            }

            // Normal User Message
            await updateDoc(doc(db, `artifacts/${appId}/public/data/chats`, currentChatId), {
                messages: [...window.currentChatData.messages, {sender: 'user', text: text, time: new Date().toISOString()}]
            });
        };

        let botStep = 0;
        let tempUserName = '';

        async function handleBotFlow(text) {
            appendMessage('user', text);

            if(botStep === 0) {
                tempUserName = text;
                botStep++;
                setTimeout(() => appendMessage('bot', `ØªØ´Ø±ÙØª Ø¨Ùƒ ÙŠØ§ ${tempUserName}. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§ØªØŸ`), 600);
            } else if (botStep === 1) {
                // Create Chat in Firestore
                const chatRef = await addDoc(collection(db, `artifacts/${appId}/public/data/chats`), {
                    userId: currentUser.uid,
                    userName: tempUserName,
                    userRequest: text,
                    status: 'waiting', // waiting for admin
                    messages: [
                        {sender: 'bot', text: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨Ùƒ! Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ø£Ø­Ø¯ Ù…Ù…Ø«Ù„ÙŠ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø­Ø§Ù„Ø§Ù‹.', time: new Date().toISOString()}
                    ],
                    createdAt: serverTimestamp()
                });
                currentChatId = chatRef.id;
                setupUserChatListener();
            }
        }

        function appendMessage(sender, text) {
            const div = document.createElement('div');
            div.className = `flex ${sender === 'user' ? 'justify-start' : 'justify-end'} mb-2`;
            
            let bgClass = '';
            if(sender === 'user') bgClass = 'bg-emerald-100 text-emerald-900 rounded-br-none';
            else if(sender === 'bot') bgClass = 'bg-gray-100 text-gray-800 rounded-bl-none';
            else bgClass = 'bg-blue-100 text-blue-900 rounded-bl-none border border-blue-200'; // Admin

            div.innerHTML = `
                <div class="${bgClass} py-2 px-4 rounded-2xl max-w-[80%] text-sm shadow-sm">
                    ${text}
                </div>
            `;
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function setupUserChatListener() {
            if(!currentChatId) return;

            onSnapshot(doc(db, `artifacts/${appId}/public/data/chats`, currentChatId), (docSnap) => {
                if(docSnap.exists()) {
                    window.currentChatData = docSnap.data();
                    const msgs = docSnap.data().messages;
                    
                    // Clear and redraw ONLY if length changed to avoid jitter (simple approach)
                    chatMessages.innerHTML = '';
                    msgs.forEach(m => appendMessage(m.sender, m.text));

                    if(docSnap.data().status === 'closed') {
                        appendMessage('bot', 'ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©. Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§!');
                        document.getElementById('chat-input').disabled = true;
                        currentChatId = null;
                        botStep = 0;
                    }
                }
            });
        }

        // --- Admin Chat Logic ---
        function loadActiveChats() {
            const q = query(collection(db, `artifacts/${appId}/public/data/chats`), where('status', '!=', 'closed'));
            onSnapshot(q, (snapshot) => {
                const list = document.getElementById('admin-chat-list');
                list.innerHTML = '';
                snapshot.forEach(d => {
                    const data = d.data();
                    const activeClass = adminActiveChatId === d.id ? 'bg-emerald-50 border-emerald-500' : 'border-transparent hover:bg-gray-50';
                    list.innerHTML += `
                        <div onclick="openAdminChat('${d.id}')" class="p-3 border-l-4 ${activeClass} cursor-pointer border-b transition-all">
                            <div class="flex justify-between font-bold text-sm">
                                <span>${data.userName}</span>
                                <span class="text-xs text-gray-400">${data.status === 'waiting' ? 'ğŸ”´ Ø§Ù†ØªØ¸Ø§Ø±' : 'ğŸŸ¢ Ù†Ø´Ø·'}</span>
                            </div>
                            <div class="text-xs text-gray-500 truncate mt-1">${data.userRequest}</div>
                        </div>
                    `;
                });
            });
        }

        window.openAdminChat = (chatId) => {
            adminActiveChatId = chatId;
            loadActiveChats(); // Refresh UI highlight
            
            // Listen to this specific chat
            onSnapshot(doc(db, `artifacts/${appId}/public/data/chats`, chatId), (docSnap) => {
                const data = docSnap.data();
                const adminMsgBox = document.getElementById('admin-messages');
                adminMsgBox.innerHTML = '';
                data.messages.forEach(m => {
                    const align = m.sender === 'support' ? 'text-left' : 'text-right';
                    const bg = m.sender === 'support' ? 'bg-blue-100' : 'bg-gray-100';
                    adminMsgBox.innerHTML += `<div class="${align} mb-2"><span class="inline-block px-3 py-1 rounded ${bg} text-sm">${m.text}</span></div>`;
                });
                adminMsgBox.scrollTop = adminMsgBox.scrollHeight;
                
                // Show user info header
                document.getElementById('admin-chat-header-info').innerText = `Ù…Ø¹: ${data.userName} (${data.userRequest})`;
            });
            
            document.getElementById('admin-chat-view').classList.remove('hidden');
            // Change status to active if waiting
            updateDoc(doc(db, `artifacts/${appId}/public/data/chats`, chatId), { status: 'active' });
        };

        window.adminSendMessage = async () => {
            const input = document.getElementById('admin-input');
            const text = input.value.trim();
            if(!text || !adminActiveChatId) return;
            
            const chatRef = doc(db, `artifacts/${appId}/public/data/chats`, adminActiveChatId);
            const docSnap = await getDocs(query(collection(db, `artifacts/${appId}/public/data/chats`), where('__name__', '==', adminActiveChatId)));
            
            // Need to get current messages first
            // Simplified: using arrayUnion not optimal for message order, so we fetch-update
            // But for speed in this demo, we assume we have the array locally from snapshot or just push
            // Better:
            let currentMsgs = [];
            // We rely on the snapshot listener updating a local var or just push blindly? 
            // Let's fetch fresh to be safe
             // (In a real app, we'd use the snapshot data we already have)
             // Re-fetching for safety in this code block structure:
            // Note: Since we are inside a module, let's just append to what we know? No, concurrency.
            // We will use Firestore arrayUnion for simplicity or read-write.
            // Let's do a quick read-write transaction pattern via getDoc for simplicity
             // Actually, we can just use arrayUnion if we don't care strictly about milliseconds order clashes, but here we want robust.
             // Let's just read the doc again.
             // Wait, we have a snapshot listener. But to send, let's just update.
             
             // Quick Fix: We'll fetch the doc inside this function to get array.
             // A simpler way for this demo:
             // We already have a listener on 'adminActiveChatId'.
             // We need the current array.
             // Let's just use arrayUnion from firestore? No, `messages` is an array of objects.
             // Firestore `arrayUnion` works on exact object match.
             // We will use `getDoc` then `updateDoc`.
             
             // Actually, let's just use the logic:
             // We assume 'adminActiveChatId' is valid.
             // We need to fetch current messages to append.
             // But wait! We have onSnapshot running!
             // Ideally we store currentAdminChatData in a variable.
             // Let's assume we fetch it:
             
             // For this code structure, I will use runTransaction or just getDoc/updateDoc.
             // Since I cannot easily use runTransaction with the imports I declared (need to import it), I will import getDoc.
             // I imported getDoc.
            
             const d = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js");
             const snap = await d.getDoc(chatRef);
             if(snap.exists()) {
                 const msgs = snap.data().messages;
                 msgs.push({sender: 'support', text: text, time: new Date().toISOString()});
                 await updateDoc(chatRef, { messages: msgs });
                 input.value = '';
             }
        };

        window.kickUser = async () => {
            if(!adminActiveChatId) return;
            if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ·Ø±Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ')) {
                await updateDoc(doc(db, `artifacts/${appId}/public/data/chats`, adminActiveChatId), { status: 'closed' });
                adminActiveChatId = null;
                document.getElementById('admin-chat-view').classList.add('hidden');
                document.getElementById('admin-messages').innerHTML = '';
                showToast('ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©', 'info');
            }
        };

        // --- UI Utilities ---
        window.showToast = (msg, type = 'success') => {
            const toast = document.createElement('div');
            const bg = type === 'success' ? 'bg-emerald-600' : (type === 'error' ? 'bg-red-500' : 'bg-blue-500');
            toast.className = `fixed top-4 left-1/2 transform -translate-x-1/2 ${bg} text-white px-6 py-3 rounded-full shadow-xl z-50 flex items-center gap-2 transition-all duration-500 opacity-0 translate-y-[-20px]`;
            toast.innerHTML = `<span>${msg}</span>`;
            document.body.appendChild(toast);
            
            requestAnimationFrame(() => {
                toast.classList.remove('opacity-0', 'translate-y-[-20px]');
            });
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-[-20px]');
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        };

        window.toggleAddModal = () => {
            const m = document.getElementById('add-listing-modal');
            m.classList.toggle('hidden');
        };

        window.filterListings = (type) => {
            const all = window.appState.listings;
            if(type === 'all') {
                renderListings(all);
            } else {
                const filtered = all.filter(i => i.type === type);
                renderListings(filtered);
            }
            // Update active button styles
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('bg-emerald-600', 'text-white');
                b.classList.add('bg-white', 'text-slate-600');
            });
            const activeBtn = document.getElementById(`btn-${type}`);
            activeBtn.classList.remove('bg-white', 'text-slate-600');
            activeBtn.classList.add('bg-emerald-600', 'text-white');
        };

    </script>

    <!-- Navigation -->
    <nav class="fixed w-full z-40 transition-all duration-300 glass-effect shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer group" id="site-logo">
                <div class="bg-emerald-600 p-2 rounded-xl text-white group-hover:rotate-12 transition-transform">
                    <i data-lucide="home" class="w-6 h-6"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-extrabold text-slate-800 tracking-tight">Ø§Ù„Ø³ÙˆÙ‚ <span class="text-emerald-600">ÙˆÙŠØ§Ùƒ</span></h1>
                    <p class="text-xs text-slate-400 -mt-1">Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</p>
                </div>
            </div>
            
            <div class="hidden md:flex gap-8 font-medium text-slate-600">
                <a href="#home" class="hover:text-emerald-600 transition">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="#services" class="hover:text-emerald-600 transition">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</a>
                <a href="#contact" class="hover:text-emerald-600 transition">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
            </div>

            <button onclick="toggleAddModal()" class="bg-slate-900 text-white px-5 py-2 rounded-full hover:bg-emerald-600 transition shadow-lg flex items-center gap-2 text-sm font-bold">
                <i data-lucide="plus-circle" class="w-4 h-4"></i>
                <span>Ø£Ø¶Ù Ø¹Ù‚Ø§Ø±Ùƒ</span>
            </button>
        </div>
    </nav>

    <!-- Hero Section -->
    <header id="home" class="pt-32 pb-20 px-4 bg-gradient-to-br from-slate-50 to-emerald-50/50 relative overflow-hidden">
        <!-- Background decoration -->
        <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
            <div class="absolute right-[-100px] top-[-100px] w-96 h-96 bg-emerald-300 rounded-full blur-3xl"></div>
            <div class="absolute left-[-100px] bottom-[-100px] w-96 h-96 bg-blue-300 rounded-full blur-3xl"></div>
        </div>

        <div class="container mx-auto text-center relative z-10">
            <span class="bg-emerald-100 text-emerald-700 px-4 py-1 rounded-full text-sm font-bold mb-4 inline-block">Ø£ÙØ¶Ù„ Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±ÙŠØ© ÙÙŠ Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚</span>
            <h2 class="text-4xl md:text-6xl font-black text-slate-800 mb-6 leading-tight">Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†Ø²Ù„Ùƒ Ø§Ù„Ù‚Ø§Ø¯Ù…<br>Ø¨ÙƒÙ„ <span class="text-emerald-600 relative inline-block">Ø³Ù‡ÙˆÙ„Ø©<svg class="absolute bottom-0 left-0 w-full h-3 text-emerald-200 -z-10" fill="currentColor" viewBox="0 0 100 10"><path d="M0 5 Q 50 10 100 5 L 100 10 L 0 10 Z"></path></svg></span></h2>
            <p class="text-slate-500 text-lg mb-10 max-w-2xl mx-auto">Ù†Ø­Ù† Ù†Ø±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§Ù„Ù…Ø´ØªØ±ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©. Ù„Ø§ Ø¹Ù…ÙˆÙ„Ø§Øª Ø®ÙÙŠØ©ØŒ Ø¯Ø¹Ù… ÙÙ†ÙŠ Ù…Ø¨Ø§Ø´Ø±ØŒ ÙˆØ£ÙØ¶Ù„ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©.</p>
            
            <!-- Featured Section (Pinned by Admin) -->
            <div id="featured-section" class="hidden mt-12 text-right max-w-6xl mx-auto">
                <div class="flex items-center gap-2 mb-4">
                    <i data-lucide="zap" class="text-yellow-500 fill-yellow-500"></i>
                    <h3 class="text-xl font-bold">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù…ÙŠØ²Ø© ÙˆÙ…Ø«Ø¨ØªØ©</h3>
                </div>
                <div id="featured-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Pinned Items will be injected here -->
                </div>
            </div>
        </div>
    </header>

    <!-- Services/Listings Section -->
    <section id="services" class="py-20 px-4 container mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div>
                <h3 class="text-3xl font-bold text-slate-800">Ø£Ø­Ø¯Ø« Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</h3>
                <p class="text-slate-500 mt-2">ØªØµÙØ­ Ø£Ø­Ø¯Ø« Ø§Ù„Ø´Ù‚Ù‚ØŒ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠØŒ ÙˆØ§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</p>
            </div>
            <div class="bg-white p-1 rounded-xl shadow-sm border border-gray-100 flex">
                <button id="btn-all" onclick="filterListings('all')" class="filter-btn bg-emerald-600 text-white px-6 py-2 rounded-lg font-medium transition-all shadow-sm">Ø§Ù„ÙƒÙ„</button>
                <button id="btn-sale" onclick="filterListings('sale')" class="filter-btn bg-white text-slate-600 px-6 py-2 rounded-lg font-medium transition-all hover:bg-slate-50">Ø¨ÙŠØ¹</button>
                <button id="btn-rent" onclick="filterListings('rent')" class="filter-btn bg-white text-slate-600 px-6 py-2 rounded-lg font-medium transition-all hover:bg-slate-50">Ø¥ÙŠØ¬Ø§Ø±</button>
            </div>
        </div>

        <div id="listings-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Skeleton Loading -->
            <div class="bg-white rounded-2xl shadow p-4 animate-pulse">
                <div class="h-40 bg-gray-200 rounded-xl mb-4"></div>
                <div class="h-6 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
            <div class="bg-white rounded-2xl shadow p-4 animate-pulse">
                <div class="h-40 bg-gray-200 rounded-xl mb-4"></div>
                <div class="h-6 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 bg-slate-900 text-white relative overflow-hidden">
        <div class="absolute top-0 right-0 w-64 h-64 bg-emerald-600 rounded-full blur-[100px] opacity-20"></div>
        
        <div class="container mx-auto px-4 grid md:grid-cols-2 gap-12 items-center">
            <div>
                <h3 class="text-4xl font-bold mb-6">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©</h3>
                <p class="text-slate-400 mb-8 text-lg">ÙØ±ÙŠÙ‚Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚ ÙˆØ§Ù„Ø´Ø±Ù‚ÙŠØ©. Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ.</p>
                
                <div class="space-y-6">
                    <div class="flex items-center gap-4 bg-white/5 p-4 rounded-xl border border-white/10 hover:bg-white/10 transition">
                        <div class="bg-emerald-500 p-3 rounded-lg">
                            <i data-lucide="map-pin" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</h4>
                            <p class="text-slate-300">Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚ØŒ Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©ØŒ Ù…ØµØ±</p>
                        </div>
                    </div>
                    
                    <a href="https://wa.me/201206244875" target="_blank" class="flex items-center gap-4 bg-white/5 p-4 rounded-xl border border-white/10 hover:bg-white/10 transition cursor-pointer group">
                        <div class="bg-green-500 p-3 rounded-lg group-hover:scale-110 transition">
                            <i data-lucide="message-circle" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg">ÙˆØ§ØªØ³Ø§Ø¨</h4>
                            <p class="text-slate-300">01206244875</p>
                        </div>
                    </a>

                    <a href="https://www.facebook.com/share/17WdF9DX9x/" target="_blank" class="flex items-center gap-4 bg-white/5 p-4 rounded-xl border border-white/10 hover:bg-white/10 transition cursor-pointer group">
                        <div class="bg-blue-600 p-3 rounded-lg group-hover:scale-110 transition">
                            <i data-lucide="facebook" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg">ÙÙŠØ³Ø¨ÙˆÙƒ</h4>
                            <p class="text-slate-300">ØªØ§Ø¨Ø¹Ù†Ø§ Ø¹Ù„Ù‰ ØµÙØ­ØªÙ†Ø§ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</p>
                        </div>
                    </a>
                </div>
            </div>
            
            <div class="bg-white rounded-3xl p-1 overflow-hidden">
               <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d55064.43080969958!2d31.5185966!3d30.5876762!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14f7f0c2714b7b0f%3A0x666227543424573a!2sZagazig%2C%20Ash%20Sharqia%20Governorate!5e0!3m2!1sen!2seg!4v1700000000000!5m2!1sen!2seg" width="100%" height="400" style="border:0; border-radius: 20px;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-950 text-slate-600 py-8 text-center text-sm">
        <p>Â© 2025 Ø§Ù„Ø³ÙˆÙ‚ ÙˆÙŠØ§Ùƒ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </footer>

    <!-- Support Chat Widget (Floating) -->
    <div class="fixed bottom-6 left-6 z-50">
        <!-- User Chat Button -->
        <button onclick="toggleChat()" id="fab-icon-user" class="bg-emerald-600 text-white p-4 rounded-full shadow-2xl hover:bg-emerald-700 hover:scale-110 transition-all animate-bounce-slow relative">
            <span class="absolute top-0 right-0 flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
            </span>
            <i data-lucide="headset" class="w-6 h-6"></i>
        </button>

        <!-- Admin Dashboard Button (Hidden initially) -->
        <button onclick="toggleAdminPanel()" id="fab-icon-admin" class="hidden bg-blue-600 text-white p-4 rounded-full shadow-2xl hover:bg-blue-700 hover:scale-110 transition-all border-4 border-white">
            <i data-lucide="shield-alert" class="w-6 h-6"></i>
        </button>

        <!-- User Chat Window -->
        <div id="chat-window" class="hidden absolute bottom-20 left-0 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden flex flex-col chat-slide-in" style="height: 400px;">
            <div class="bg-emerald-600 p-4 text-white flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <div class="bg-white/20 p-1.5 rounded-lg"><i data-lucide="bot" class="w-5 h-5"></i></div>
                    <div>
                        <h4 class="font-bold text-sm">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h4>
                        <p class="text-xs text-emerald-100">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</p>
                    </div>
                </div>
                <button onclick="toggleChat()" class="hover:bg-emerald-700 p-1 rounded"><i data-lucide="x" class="w-4 h-4"></i></button>
            </div>
            <div id="chat-messages" class="flex-1 p-4 overflow-y-auto bg-slate-50">
                <!-- Messages go here -->
            </div>
            <div class="p-3 bg-white border-t border-gray-100 flex gap-2">
                <input type="text" id="chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." class="flex-1 bg-gray-100 border-none rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-emerald-500 outline-none">
                <button onclick="sendMessage()" class="bg-emerald-600 text-white p-2 rounded-xl hover:bg-emerald-700 transition"><i data-lucide="send" class="w-4 h-4"></i></button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard Panel (Overlay) -->
    <div id="admin-panel" class="hidden fixed inset-0 bg-black/50 z-50 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-4xl h-[80vh] rounded-3xl shadow-2xl flex overflow-hidden">
            <!-- Sidebar List -->
            <div class="w-1/3 border-l bg-gray-50 flex flex-col">
                <div class="p-4 border-b bg-white flex justify-between items-center">
                    <h3 class="font-bold text-lg text-slate-800">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¸Ø±ÙŠÙ†</h3>
                    <button onclick="loadActiveChats()" class="text-emerald-600 hover:bg-emerald-50 p-1 rounded"><i data-lucide="refresh-cw" class="w-4 h-4"></i></button>
                </div>
                <div id="admin-chat-list" class="overflow-y-auto flex-1">
                    <!-- Dynamic List -->
                </div>
            </div>
            
            <!-- Chat View -->
            <div class="w-2/3 flex flex-col bg-white relative">
                <button onclick="toggleAdminPanel()" class="absolute top-4 left-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-500 p-2 rounded-full transition"><i data-lucide="x" class="w-5 h-5"></i></button>
                
                <div id="admin-chat-view" class="hidden flex flex-col h-full">
                    <div class="p-4 border-b flex justify-between items-center bg-blue-50/50">
                        <div id="admin-chat-header-info" class="font-bold text-blue-900">Ø§Ø®ØªØ± Ù…Ø­Ø§Ø¯Ø«Ø©</div>
                        <button onclick="kickUser()" class="bg-red-100 text-red-600 px-3 py-1 rounded-lg text-xs font-bold hover:bg-red-200 flex items-center gap-1">
                            <i data-lucide="user-x" class="w-3 h-3"></i> Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                        </button>
                    </div>
                    <div id="admin-messages" class="flex-1 p-4 overflow-y-auto bg-slate-50 space-y-2"></div>
                    <div class="p-4 border-t">
                        <div class="flex gap-2">
                            <input id="admin-input" type="text" class="flex-1 border rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Ø±Ø¯ Ø¨ØµÙØªÙƒ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ...">
                            <button onclick="adminSendMessage()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
                        </div>
                    </div>
                </div>

                <div id="admin-empty-state" class="flex-1 flex flex-col items-center justify-center text-gray-300">
                    <i data-lucide="message-square" class="w-16 h-16 mb-4"></i>
                    <p>Ø§Ø®ØªØ± Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„Ø¨Ø¯Ø¡</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Listing Modal -->
    <div id="add-listing-modal" class="hidden fixed inset-0 bg-black/80 z-50 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto p-6 animate-scale-up relative">
            <button onclick="toggleAddModal()" class="absolute top-4 left-4 text-gray-400 hover:text-red-500"><i data-lucide="x" class="w-6 h-6"></i></button>
            <h2 class="text-2xl font-bold text-slate-800 mb-6">Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø± Ø¬Ø¯ÙŠØ¯</h2>
            
            <form id="listing-form" onsubmit="event.preventDefault(); submitListing();" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
                    <input type="text" id="prop-title" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none" placeholder="Ù…Ø«Ø§Ù„: Ø´Ù‚Ø© ÙØ§Ø®Ø±Ø© ÙÙŠ Ø§Ù„Ù‚ÙˆÙ…ÙŠØ©">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Ø§Ù„Ø³Ø¹Ø± (Ø¬.Ù…)</label>
                        <input type="number" id="prop-price" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none" placeholder="1000000">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Ø§Ù„Ù†ÙˆØ¹</label>
                        <select id="prop-type" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none bg-white">
                            <option value="sale">Ø¨ÙŠØ¹</option>
                            <option value="rent">Ø¥ÙŠØ¬Ø§Ø±</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label>
                    <input type="text" id="prop-location" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none" placeholder="Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚ - Ø­ÙŠ Ø§Ù„Ø²Ù‡ÙˆØ±">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Ø§Ù„ÙˆØµÙ</label>
                    <textarea id="prop-desc" rows="3" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none" placeholder="Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø´Ù‚Ø©ØŒ Ø§Ù„Ù…Ø³Ø§Ø­Ø©ØŒ Ø§Ù„Ø¯ÙˆØ±..."></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„ØªÙˆØ§ØµÙ„</label>
                    <input type="tel" id="prop-phone" class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-emerald-500 outline-none" placeholder="01xxxxxxxxx">
                </div>
                
                <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:bg-gray-50 transition cursor-pointer relative">
                    <input type="file" accept="image/*" onchange="handleImageUpload(this)" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                    <div class="space-y-2">
                        <i data-lucide="image-plus" class="w-8 h-8 mx-auto text-gray-400"></i>
                        <p class="text-sm text-gray-500">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</p>
                    </div>
                    <img id="preview-image" class="hidden mt-4 w-full h-40 object-cover rounded-lg mx-auto">
                </div>

                <button type="submit" class="w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-emerald-600 transition flex justify-center items-center gap-2">
                    <span id="submit-btn-text">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</span>
                    <i data-lucide="arrow-left" class="w-4 h-4"></i>
                </button>
            </form>
        </div>
    </div>

    <script>
        // Initialize Icons
        lucide.createIcons();
    </script>
</body>
</html>

